{"version":3,"sources":["app.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["\"use strict\";\n\nvar app = (function () {\n\n    var winWidth = document.documentElement.clientWidth,\n        winHeight = document.documentElement.clientHeight;\n\n    var _onLoad = function() {\n\n        var ps;\n        var psList;\n\n        var headroom  = new Headroom( document.getElementById('headroom') );\n        headroom.init();\n\n        $(document).mouseup(function (e) {\n            var div = $(\".js-outsideclick\");\n\n            if (!div.is(e.target) && div.has(e.target).length === 0) {\n                div.removeClass('is-active');\n                $('html,body').removeClass('is-modal-active');\n            }\n        });\n\n        $(document).mouseup(function (e) {\n            var div = $(\".js-outsideclick-search-users\");\n\n            if (!div.is(e.target) && div.has(e.target).length === 0) {\n                div.removeClass('is-active');\n            }\n        });\n\n\n        // включалка поиска\n        $('.js-search-ctrl').on('click', function(e) {\n            e.preventDefault();\n\n            $('#searchBody').toggleClass('is-active');\n            $('#logo').toggleClass('is-moveup');\n\n            $(this).parents('form').get(0).reset();\n        });\n\n\n        // включалка модалок\n        $('[data-toggle]').on('click', function(e) {\n            e.preventDefault();\n\n            // закрываем все модалки\n            $('.js-modal').removeClass('is-active');\n\n            // сворачиваем список пользователей категории\n            $('.js-categoryCard-list').removeClass('is-active');\n            $('.js-categoryCard-list').css('max-height', '');\n            $('.js-categoryCard-list').scrollTop(0);\n            if ( psList ) { psList.destroy(); }\n            // отключаем активность кнопки сворачивания\n            $('.categoryCardExpander').removeClass('is-active');\n\n            // отключаем блоки в модалке\n            $('.js-modal .js-modal-body').addClass('hidden');\n\n            // id цели\n            var id = $(this).attr('href');\n\n            // показываем первую вкладку в модалке\n            $(id).find('.js-modal-body').eq(0).removeClass('hidden');\n\n            var target = document.querySelector(id);\n            var targetScroll = target.querySelector('.js-perfectScrollbar');\n\n            if ( targetScroll ) {\n                // if ( ps ) ps.destroy();\n                // ps = new PerfectScrollbar( targetScroll );\n            }\n\n            if ( $(this).hasClass('is-active') ) {\n\n                $(id).removeClass('is-active');\n                $('html,body').removeClass('is-modal-active');\n                $(this).removeClass('is-active');\n\n            } else {\n\n                $(this).addClass('is-active');\n                $(id).addClass('is-active');\n                $('html,body').addClass('is-modal-active');\n\n            }\n        });\n\n\n        // закрыватель модалки (закрывает все модалки)\n        $('[data-modal-close]').on('click', function(e) {\n            e.preventDefault();\n\n            $('html,body').removeClass('is-modal-active');\n            $('.js-modal').removeClass('is-active');\n            $('[data-toggle]').removeClass('is-active');\n        });\n\n\n        // переключатель внутри модалки\n        $('[data-modal-switch]').on('click', function(e) {\n            e.preventDefault();\n\n            $('.js-modal-body').addClass('hidden');\n\n            var id = $(this).attr('href');\n\n            var target = document.querySelector(id);\n            var targetScroll = target.querySelector('.js-perfectScrollbar');\n\n            $(id).removeClass('hidden');\n\n            if ( targetScroll ) {\n                // if ( ps ) ps.destroy();\n                // ps = new PerfectScrollbar( targetScroll );\n\n                var targetScrollValue = targetScroll.scrollTop;\n\n                if ( targetScrollValue > 0 ) {\n                    targetScroll.scrollTop = 0;\n                }\n            }\n        });\n\n        // разворачивалка списка пользователей в катрочке категории\n        $('[data-expand-userlist]').on('click', function(e) {\n            e.preventDefault();\n\n            var $list = $(this).parent().find('.js-categoryCard-list');\n\n            var $modal = $(this).parents('.modal');\n            var modalHeight = $modal.height();\n\n            if ( $list.hasClass('is-active') ) {\n\n                $list.css('max-height', '');\n                psList.destroy();\n                $list.scrollTop(0);\n\n            } else {\n\n                $list.css('max-height', modalHeight + 'px');\n                if ( psList ) psList.destroy();\n                psList = new PerfectScrollbar( $list.get(0), {\n                    // wheelPropagation: true\n                });\n\n            }\n\n            var $modalScroll = $modal.find('.js-perfectScrollbar');\n            var modalScrollValue = $modalScroll.scrollTop();\n\n            // if ( ps ) ps.destroy();\n            // ps = new PerfectScrollbar( $modalScroll.get(0) );\n\n            if ( modalScrollValue > 0 ) {\n                $modalScroll.scrollTop(0);\n            }\n\n            $(this).toggleClass('is-active');\n            $list.toggleClass('is-active');\n        });\n\n        $('[data-block-expander]').on('click', function(e) {\n            e.preventDefault();\n\n            var id = $(this).attr('href');\n\n            $(id).toggleClass('is-expanded');\n\n            if ( ps ) ps.update();\n        });\n\n\n        // поиск\n        $('#search').on('submit', function(e) {\n            e.preventDefault();\n\n            $('#cardsContainer').removeClass('is-loaded');\n\n            // здесь будет обработка запроса\n\n            setTimeout(function() {\n                $('#cardsContainer').addClass('is-loaded');\n            }, 1000);\n        });\n\n\n        // поиск пользователей\n        $('.js-people-search-input').on('keyup', function(e) {\n            // запускаем поиск\n            var value = $(this).val();\n            var $searchListContainer = $(this).parent().find('.js-people-search-list');\n\n            // если есть текст\n            if ( value ) {\n                var searchStr = value.toLowerCase();\n                var values = $searchListContainer.find('.js-value');\n                var length = 0;\n\n                $.each(values, function(idx, item) {\n                    var itemText = $(item).text();\n\n                    if ( itemText.toLowerCase().indexOf( searchStr ) === -1 ) {\n\n                        $(item).parents('.js-people-search-list-item').hide();\n\n                    } else {\n\n                        // найдено\n                        length += 1;\n                        // $searchListContainer.show();\n                        $searchListContainer.addClass('is-active');\n                        $(item).parents('.js-people-search-list-item').show();\n\n                    }\n                });\n\n                if (length > 0) {\n                    $searchListContainer.addClass('is-active');\n                } else {\n                    $searchListContainer.removeClass('is-active');\n                }\n\n            } else {\n                // если текста нет\n                $searchListContainer.removeClass('is-active');\n            }\n        });\n\n        // добавляем пользователя в список\n        $('.js-people-search-list-item').on('click', function(e) {\n            var $container = $(this).parents('.js-category-people');\n\n            var imgPic = $(this).find('img').attr('src');\n            var name = $(this).find('.js-value').text();\n            var html = '<div class=\"categoryUserList-item js-category-people-item\"><div class=\"userPic userPic--ctrl\"><img src=\"'+imgPic+'\" alt=\"'+name+'\"/><svg class=\"icon\"><use xlink:href=\"assets/img/sprite.svg#cross\"></use></svg></div></div>';\n\n            $container.find('.js-people-search-input').val('');\n\n            $container.find('.js-category-people-list').append(html);\n            $container.find('.js-people-search-list').removeClass('is-active');\n        });\n\n        // удалить пользователя\n        $('body').on('click', '.js-category-people-item', function(e) {\n            e.preventDefault();\n\n            $(this).remove();\n        });\n\n        // форма\n        $('.js-category-people-form').on('submit', function(e) {\n            e.preventDefault();\n\n            var btn = $(this).find('button[type=\"submit\"]');\n            btn.attr('disabled', true);\n            btn.addClass('is-process');\n\n            var formData = $(this).serialize();\n\n            setTimeout( function() {\n                btn.attr('disabled', false);\n                btn.removeClass('is-process');\n            }, 2000);\n        });\n\n    };\n\n    var init = function () {\n        svg4everybody();\n        document.addEventListener('DOMContentLoaded', _onLoad);\n    };\n\n    return { init: init };\n})();\napp.init();"]}